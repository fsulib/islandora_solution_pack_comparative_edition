# How Indexing Works

The primary feature of the Islandora Comparative Edition Solution Pack is the ability to compare sentences across several witnesses, and these sentences are collated together into one master file during what we refer to as "the indexing process". This process is triggered every time a new witness is ingested or deleted, as well as any time a PINDEX datastream on a page object is replaced. The process works differently depending on whether a CollateX server has been configured in the admin menu; if no CollateX server is available then the entire sentence is collated with other sentences using the same ID, but if a CollateX server IS available, the indexing process includes an extra step of sending all sentences to the CollateX server to be tokenized and compared for variance, with this data being stored directly in the MINDEX via HTML tags.

To see how indexing works in the code, see the [IslandoraComparativeEditionObject::generateMindex()](https://github.com/fsulib/islandora_solution_pack_comparative_edition/blob/master/includes/classes.inc#L111-L172) function which kicks off the indexing process. If CollateX isn't available, [IslandoraComparativeEditionObject::formatSentenceUnaligned](https://github.com/fsulib/islandora_solution_pack_comparative_edition/blob/master/includes/classes.inc#L10-L23) is used. If CollateX is enabled, [IslandoraComparativeEditionObject::formatSentenceAligned](https://github.com/fsulib/islandora_solution_pack_comparative_edition/blob/master/includes/classes.inc#L25-L109) is used which is a much more complicated process compared to IslandoraComparativeEditionObject::formatSentenceUnaligned.
